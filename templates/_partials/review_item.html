<div class="comment mb-4 p-2 border rounded" id="review-{{ review.id }}">
  <div class="d-flex align-items-center justify-content-between">
    <div class="d-flex align-items-center comment-head">
      <img loading="lazy" src="{{ profile_src(review.user_profile_pic) }}"
           alt="Foto de Perfil"
           class="profile-img mr-2">
      <div class="d-flex flex-column flex-sm-row align-items-sm-center comment-meta">
        <a href="{{ url_for('user_profile', user_id=review.user_id) }}" class="user-profile-link mr-sm-2">
          <strong class="comment-username">{{ review.user_nickname }}</strong>
        </a>
        <small class="comment-date">{{ review.created_at | fmt_dt }}</small>
      </div>
    </div>
    {% if user and (user.id if user is mapping else user.get('id')) == review.user_id %}
      <div>
        <button class="btn btn-sm btn-outline-primary edit-review" data-review-id="{{ review.id }}">Editar</button>
        <button class="btn btn-sm btn-outline-danger delete-review" data-review-id="{{ review.id }}">Eliminar</button>
      </div>
    {% endif %}
  </div>
  <p class="review-text mt-2">{{ review.review_text }}</p>
  <p class="rating">Calificaci√≥n:
    {% for i in range(review.rating|int) %}
      <i class="fas fa-star"></i>
    {% endfor %}
    {% for i in range(5 - (review.rating|int)) %}
      <i class="far fa-star"></i>
    {% endfor %}
  </p>
</div>

<style>
.profile-img{width:40px;height:40px;border-radius:50%;object-fit:cover;border:2px solid #f00;flex-shrink:0;margin-right:22px}
.comment-username{color:#fff;word-break:break-word}
.comment-date{color:#fff;opacity:.9}
.comment-meta{gap:.8rem}
.review-text{white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere}
@media(max-width:768px){
  .comment-head{align-items:flex-start}
  .comment-meta{gap:.8rem}
  .comment-date{margin-top:2px;display:block}
}
</style>
